   10 REM TWIST2_ALI.BAS
   20 :
   30 REM WRITTEN BY PETE NYHOLM
   40 REM CREDIT FOR PROC_LOAD_LOGO AND PROC_DRAW_LOGO TO STEVE LOVEJOY
   50 REM CODE BASED ON ORIGINAL BOOTSCREEN.BAS VERSION 2.0
   60 REM CREDIT FOR ICON TO ARNOLD MESZAROS
   65 REM TESTED FOR MODE 0
   70 :
   80 DIM L$(7) : REM INITIALIZE LOGO STRING ARRAY 
   90 L$(0)="  "+CHR$(200)+CHR$(201)+"   "
  100 L$(1)="  "+CHR$(202)+CHR$(203)+"   "
  110 L$(2)=" "+CHR$(204)+CHR$(205)+CHR$(206)+CHR$(207)+"  "
  120 L$(3)=CHR$(208)+CHR$(209)+CHR$(210)+CHR$(211)+CHR$(212)+CHR$(213)+" "
  130 L$(4)=CHR$(214)+CHR$(215)+CHR$(216)+CHR$(209)+CHR$(217)+CHR$(218)+" "
  140 L$(5)=CHR$(219)+CHR$(220)+CHR$(221)+CHR$(222)+CHR$(223)+CHR$(224)+" "
  150 L$(6)=CHR$(225)+CHR$(226)+CHR$(227)+CHR$(228)+CHR$(229)+CHR$(230)+" "
  160 L$(7)=CHR$(231)+CHR$(232)+CHR$(233)+CHR$(234)+CHR$(235)+CHR$(236)+" "
  170 :
  180 REM DECLARE ARRAYS FOR COMPUTED POLYGON VERTICES
  190 DIM RXP(12), RYP(12)
  200 REM DECLARE ARRAYS FOR SIN AND COS TO 0.1 DEGREES 10*360DEG
  210 DIM RCOS(3600), RSIN(3600)
  220 REM SET MAXIMUM COLORS TO USE
  230 MAXC%=15
  240 BGCOL%=0 : COLOUR 128+BGCOL%
  245 MODE 0
  250 CLS
  260 PROC_LOAD_LOGO
  270 LCOL%=29 : LROW%=26
  280 PROC_DRAW_LOGO(LCOL%-10,LROW%-2,4)
  290 PRINT TAB(30,50)"COMPUTING SIN, COS ARRAYS, ANGLE=";
  300 REM SHOW FUN CIRCULAR PATTERN WHEN COMPUTING SIN AND COS
  310 R=100 : REM RADIUS OF PATTERN
  320 W=10 : REM WIDTH OF PATTERN
  330 FOR A%=0 TO 3600
  340   RCOS(A%)=COS(RAD(A%/10))
  350   RSIN(A%)=SIN(RAD(A%/10))
  360   IF (A% MOD 10) = 0 THEN PRINT TAB(63,50)"";INT(A%/10);
  370   GCOL 0,A%/10 MOD 16
  380   PLOT 4,512+R*RCOS(A%),512+R*RSIN(A%)
  390   PLOT 5,512+(R+W)*RCOS(A%),512+(R+W)*RSIN(A%)
  400   R=R+RSIN(A%)/4
  410   W=W+RCOS(A%)/4
  420 NEXT A%
  430 MAXX%=1024
  440 APER%=100
  450 CLS
  460 REM RANDOMIZE ANGLE SIZE BETWEEN POLYGON VERTICES
  470 ANGST%=10*(1+RND(29))
  480 REM RANDOMIZE SCALING FACTOR FOR EACH SUCCESSIVE POLYGON IN PATTERN 
  490 SCALE=0.8+RND(190)/1000
  500 REM LOOP FOR NUMBER OF SIDES FOR EACH POLYGON (MIN 2)
  510 FOR S%=3 TO 8
  520   FOR C%=0 TO MAXC%
  530     COLOUR C%
  540     PRINT TAB(65,40+C%)"COLOR ";C%;
  550   NEXT C%
  560   REPEAT LCOLOR%=1+RND(14) : UNTIL LCOLOR% <> BGCOL% 
  570   PROC_DRAW_LOGO(LCOL%,LROW%,LCOLOR%)
  580   PRINT TAB(54,1)"HIT B DURING PAUSE TO";
  590   PRINT TAB(54,2)" CHANGE BACKGROUND";
  600   PRINT TAB(62,11)"ANGLE=";ANGST%/10
  610   PRINT TAB(62,12)"SCALE=";SCALE;
  620   PRINT TAB(62,13)"BGCOL=";BGCOL%;
  630   PRINT TAB(62,14)"SIDES=";S%;
  640   REM CALCULATE ANGLE IN 10THS OF DEG FOR NUMBER OF SIDES
  650   AD=3600/S%
  660   C%=0
  670   X%=MAXX%/2
  680   FOR A%=0 TO AD STEP ANGST%
  690     REPEAT C%=C%+1 UNTIL C% <> BGCOL%
  700     GCOL 0,C%
  710     PROC_POLY(X%,MAXX%,A%,S%)
  720     IF C%>MAXC% THEN C%=0
  730   NEXT A%
  740   REM COMPUTE NEXT X VALUE SCALED FROM PREVIOUS UNTIL MIN OF APER%
  750   X%=X%*SCALE
  760   IF S%=3 AND X% >= APER% + 54 THEN GOTO 680
  770   IF S%=4 AND X% >= APER% + 32 THEN GOTO 680
  780   IF S%>4 AND X% >= APER% THEN GOTO 680
  790   REM INTRODUCE DELAY BETWEEN EACH NEW NUMBER OF SIDES
  800   K=INKEY(100)
  810   IF K=66 THEN INPUT TAB(35,58)"ENTER NEW BACKGROUND COLOR 0-15",BC$ : BGCOL%=VAL(BC$) : COLOUR 128+BGCOL%
  820   CLS
  830 NEXT S%
  840 GOTO 460
  850 END
  860 REM DEFINE PROCEDURE TO PLOT POLYGON
  870 REM GIVEN RADIUS, MAX X, STARTING ANGLE, AND NUMBER OF SIZES
  880 DEF PROC_POLY(XP%,MAXXP%,AP,NS%)
  890 CENTER%=MAXXP%/2
  900 FOR I%=1 TO NS%
  910   ADP%=INT(AP+(I%-1)*AD)
  920   RXP(I%)=CENTER%-XP%*RCOS(ADP%)
  930   RYP(I%)=CENTER%-XP%*RSIN(ADP%)
  940   IF I% = 1 THEN PLOT 4,RXP(1),RYP(1) ELSE PLOT 5,RXP(I%),RYP(I%)
  950 NEXT I%
  960 PLOT 5,RXP(1),RYP(1)
  970 ENDPROC
  980 :
  990 DEF PROC_DRAW_LOGO(COL%,ROW%,LC%) : REM **** DRAW_LOGO ****
 1000 REM DISPLAY THE LOGO LINE BY LINE.
 1010 COLOUR LC%
 1020 FOR I%=0 TO 7
 1030   PRINT TAB(COL%,ROW%+I%);L$(I%);
 1040 NEXT I%
 1050 ENDPROC : REM END PROC_DRAW_LOGO.
 1060 :
 1070 DEF PROC_LOAD_LOGO : REM **** LOAD LOGO ****
 1080 REM AGON LIGHT "Sitting Kung Fu man" LOAD LOGO CHARS.
 1090 :
 1100 FOR AC%=200 TO 237
 1110   VDU 23,AC% : FOR I%=1 TO 8 : READ V% : VDU V% : NEXT I%
 1120 NEXT AC%
 1130 ENDPROC : REM END PROC_LOAD_LOGO
 1140 :
 1150 DATA 7,15,31,31,31,31,31,63,          192,224,240,240,240,240,240,248
 1170 DATA 63,63,31,15,15,15,7,7,           248,248,240,224,224,224,192,192
 1190 DATA 0,1,7,15,31,63,127,127,          7,199,199,195,227,225,240,240
 1210 DATA 192,195,195,135,135,15,15,31,    0,0,224,240,248,252,252,254
 1230 DATA 0,0,1,1,3,3,7,7,                 255,255,255,255,255,255,255,255
 1250 DATA 248,248,248,240,224,225,193,195, 63,63,127,255,255,255,255,255
 1270 DATA 255,255,255,255,255,255,223,223, 0,0,128,128,128,192,192,192
 1290 DATA 7,7,15,15,15,15,15,31,           255,247,231,231,231,199,135,130
 1310 DATA 199,135,135,143,15,15,31,31,     207,207,207,199,199,195,129,1
 1330 DATA 224,224,224,240,240,240,240,240, 31,31,31,31,15,15,15,31
 1350 DATA 128,128,128,128,129,143,135,143, 31,63,15,0,128,224,224,195
 1370 DATA 252,240,128,0,3,7,35,243,        1,1,1,129,193,225,241,241
 1390 DATA 240,240,240,240,240,240,240,240, 31,31,3,3,3,3,7,15
 1410 DATA 223,255,255,255,255,255,254,254, 199,135,135,7,15,15,31,31
 1430 DATA 241,241,241,248,248,248,248,248, 253,255,255,255,255,255,255,127
 1450 DATA 240,248,248,224,224,224,240,248, 31,63,63,63,31,31,15,0
 1470 DATA 254,252,252,252,248,248,224,0,   31,60,32,0,0,0,0,0
 1490 DATA 120,28,12,12,0,0,0,0,            127,127,127,127,127,63,15,0
 1510 DATA 248,252,252,252,252,248,240,0,   255,254,252,248,240,224,192,128
