   10 REM TWIST2_ALI.BAS
   20 :
   30 REM WRITTEN BY PETE NYHOLM
   40 REM CREDIT FOR PROC_LOAD_LOGO AND PROC_DRAW_LOGO TO STEVE LOVEJOY
   50 REM CODE USED FROM ORIGINAL BOOTSCREEN.BAS VERSION 2.0
   60 REM CREDIT FOR ICON TO ARNOLD MESZAROS
   65 :
   70 DIM L$(7) : REM INITIALIZE LOGO STRING ARRAY 
   80 L$(0)="  "+CHR$(200)+CHR$(201)+"   "
   90 L$(1)="  "+CHR$(202)+CHR$(203)+"   "
  100 L$(2)=" "+CHR$(204)+CHR$(205)+CHR$(206)+CHR$(207)+"  "
  110 L$(3)=CHR$(208)+CHR$(209)+CHR$(210)+CHR$(211)+CHR$(212)+CHR$(213)+" "
  120 L$(4)=CHR$(214)+CHR$(215)+CHR$(216)+CHR$(209)+CHR$(217)+CHR$(218)+" "
  130 L$(5)=CHR$(219)+CHR$(220)+CHR$(221)+CHR$(222)+CHR$(223)+CHR$(224)+" "
  140 L$(6)=CHR$(225)+CHR$(226)+CHR$(227)+CHR$(228)+CHR$(229)+CHR$(230)+" "
  150 L$(7)=CHR$(231)+CHR$(232)+CHR$(233)+CHR$(234)+CHR$(235)+CHR$(236)+" "
  160 :
  170 REM DECLARE ARRAYS FOR COMPUTED POLYGON VERTICES
  180 DIM RXP(12), RYP(12)
  190 REM DECLARE ARRAYS FOR SIN AND COS TO 0.1 DEGREES 10*360DEG
  200 DIM RCOS(3600), RSIN(3600)
  210 REM SET MAXIMUM COLORS TO USE
  220 MAXC%=15
  230 BGCOL%=0 : COLOUR 128+BGCOL%
  240 CLS
  250 PROC_LOAD_LOGO
  260 LCOL%=29 : LROW%=26
  270 PROC_DRAW_LOGO(LCOL%-10,LROW%-2,4)
  280 PRINT TAB(30,50)"COMPUTING SIN, COS ARRAYS";
  290 REM SHOW FUN CIRCULAR PATTERN WHEN COMPUTING SIN AND COS
  300 R=100 : REM RADIUS OF PATTERN
  310 W=10 : REM WIDTH OF PATTERN
  320 FOR A%=0 TO 3600
  330   RCOS(A%)=COS(RAD(A%/10))
  340   RSIN(A%)=SIN(RAD(A%/10))
  350   IF (A% MOD 10) = 0 THEN PRINT TAB(30,51)"ANGLE: ";INT(A%/10);
  360   GCOL 0,A%/10 MOD 16
  370   PLOT 4,512+R*RCOS(A%),512+R*RSIN(A%)
  380   PLOT 5,512+(R+W)*RCOS(A%),512+(R+W)*RSIN(A%)
  390   R=R+RSIN(A%)/4
  400   W=W+RCOS(A%)/4
  410 NEXT A%
  420 MAXX%=1024
  430 APER%=100
  440 CLS
  450 REM RANDOMIZE ANGLE SIZE BETWEEN POLYGON VERTICES
  460 ANGST%=10*(1+RND(29))
  470 REM RANDOMIZE SCALING FACTOR FOR EACH SUCCESSIVE POLYGON IN PATTERN 
  480 SCALE=0.8+RND(190)/1000
  490 REM LOOP FOR NUMBER OF SIDES FOR EACH POLYGON (MIN 2)
  500 FOR S%=3 TO 8
  510   FOR C%=0 TO MAXC%
  520     COLOUR C%
  530     PRINT TAB(65,40+C%)"COLOR ";C%;
  540   NEXT C%
  550   REPEAT LCOLOR%=1+RND(14) : UNTIL LCOLOR% <> BGCOL% 
  560   PROC_DRAW_LOGO(LCOL%,LROW%,LCOLOR%)
  570   PRINT TAB(54,1)"HIT B DURING PAUSE TO";
  580   PRINT TAB(54,2)" CHANGE BACKGROUND";
  590   PRINT TAB(62,11)"ANGLE=";ANGST%/10
  600   PRINT TAB(62,12)"SCALE=";SCALE;
  620   PRINT TAB(62,13)"BGCOL=";BGCOL%;
  621   PRINT TAB(62,14)"SIDES=";S%;
  630   REM CALCULATE ANGLE IN 10THS OF DEG FOR NUMBER OF SIDES
  640   AD=3600/S%
  650   C%=0
  660   X%=MAXX%/2
  670   FOR A%=0 TO AD STEP ANGST%
  680     REPEAT C%=C%+1 UNTIL C% <> BGCOL%
  690     GCOL 0,C%
  700     PROC_POLY(X%,MAXX%,A%,S%)
  710     IF C%>MAXC% THEN C%=1
  720   NEXT A%
  730   REM COMPUTE NEXT X VALUE SCALED FROM PREVIOUS UNTIL MIN OF APER%
  740   X%=X%*SCALE
  750   IF S%=3 AND X% >= APER% + 54 THEN GOTO 670
  760   IF S%=4 AND X% >= APER% + 32 THEN GOTO 670
  770   IF S%>4 AND X% >= APER% THEN GOTO 670
  780   REM INTRODUCE DELAY BETWEEN EACH NEW NUMBER OF SIDES
  790   K=INKEY(100)
  800   IF K=66 THEN INPUT TAB(35,58)"ENTER NEW BACKGROUND COLOR 0-15",BC$ : BGCOL%=VAL(BC$) : COLOUR 128+BGCOL%
  810   CLS
  820 NEXT S%
  830 GOTO 440
  840 END
  850 REM DEFINE PROCEDURE TO PLOT POLYGON
  860 REM GIVEN RADIUS, MAX X, STARTING ANGLE, AND NUMBER OF SIZES
  870 DEF PROC_POLY(XP%,MAXXP%,AP,NS%)
  880 CENTER%=MAXXP%/2
  890 FOR I%=1 TO NS%
  900   ADP%=INT(AP+(I%-1)*AD)
  910   RXP(I%)=CENTER%-XP%*RCOS(ADP%)
  920   RYP(I%)=CENTER%-XP%*RSIN(ADP%)
  930 NEXT I%
  940 PLOT 4,RXP(1),RYP(1)
  950 FOR I%=2 TO NS%
  960   PLOT 5,RXP(I%),RYP(I%)
  970 NEXT I%
  980 PLOT 5,RXP(1),RYP(1)
  990 ENDPROC
 1000 :
 1010 DEF PROC_DRAW_LOGO(COL%,ROW%,LC%) : REM **** DRAW_LOGO ****
 1020 REM DISPLAY THE LOGO LINE BY LINE.
 1030 COLOUR LC%
 1040 FOR I%=0 TO 7
 1050   PRINT TAB(COL%,ROW%+I%);L$(I%);
 1060 NEXT I%
 1070 ENDPROC : REM END PROC_DRAW_LOGO.
 1080 :
 1090 DEF PROC_LOAD_LOGO : REM **** LOAD LOGO ****
 1100 REM AGON LIGHT "Sitting Kung Fu man" LOAD LOGO CHARS.
 1110 :
 1120 VDU 23,200,7,15,31,31,31,31,31,63
 1130 VDU 23,201,192,224,240,240,240,240,240,248
 1140 VDU 23,202,63,63,31,15,15,15,7,7
 1150 VDU 23,203,248,248,240,224,224,224,192,192
 1160 VDU 23,204,0,1,7,15,31,63,127,127
 1170 VDU 23,205,7,199,199,195,227,225,240,240
 1180 VDU 23,206,192,195,195,135,135,15,15,31
 1190 VDU 23,207,0,0,224,240,248,252,252,254
 1200 VDU 23,208,0,0,1,1,3,3,7,7
 1210 VDU 23,209,255,255,255,255,255,255,255,255
 1220 VDU 23,210,248,248,248,240,224,225,193,195
 1230 VDU 23,211,63,63,127,255,255,255,255,255
 1240 VDU 23,212,255,255,255,255,255,255,223,223
 1250 VDU 23,213,0,0,128,128,128,192,192,192
 1260 VDU 23,214,7,7,15,15,15,15,15,31
 1270 VDU 23,215,255,247,231,231,231,199,135,130
 1280 VDU 23,216,199,135,135,143,15,15,31,31
 1290 VDU 23,217,207,207,207,199,199,195,129,1
 1300 VDU 23,218,224,224,224,240,240,240,240,240
 1310 VDU 23,219,31,31,31,31,15,15,15,31
 1320 VDU 23,220,128,128,128,128,129,143,135,143
 1330 VDU 23,221,31,63,15,0,128,224,224,195
 1340 VDU 23,222,252,240,128,0,3,7,35,243
 1350 VDU 23,223,1,1,1,129,193,225,241,241
 1360 VDU 23,224,240,240,240,240,240,240,240,240
 1370 VDU 23,225,31,31,3,3,3,3,7,15
 1380 VDU 23,226,223,255,255,255,255,255,254,254
 1390 VDU 23,227,199,135,135,7,15,15,31,31
 1400 VDU 23,228,241,241,241,248,248,248,248,248
 1410 VDU 23,229,253,255,255,255,255,255,255,127
 1420 VDU 23,230,240,248,248,224,224,224,240,248
 1430 VDU 23,231,31,63,63,63,31,31,15,0
 1440 VDU 23,232,254,252,252,252,248,248,224,0
 1450 VDU 23,233,31,60,32,0,0,0,0,0
 1460 VDU 23,234,120,28,12,12,0,0,0,0
 1470 VDU 23,235,127,127,127,127,127,63,15,0
 1480 VDU 23,236,248,252,252,252,252,248,240,0
 1490 VDU 23,237,255,254,252,248,240,224,192,128
 1500 ENDPROC : REM END PROC_LOAD_LOGO
