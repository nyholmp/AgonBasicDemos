   10 REM TWIST2_AL.BAS
   20 :
   30 REM WRITTEN BY PETE NYHOLM
   40 REM CREDIT FOR PROC_LOAD_LOGO AND PROC_DRAW_LOGO TO STEVE LOVEJOY
   50 REM CODE USED FROM ORIGINAL BOOTSCREEN.BAS VERSION 2.0
   60 REM CREDIT FOR ICON TO ARNOLD MESZAROS
   65 REM TESTED FOR MODE 0
   70 :
   80 REM DECLARE ARRAYS FOR COMPUTED POLYGON VERTICES
   90 DIM RXP(12), RYP(12)
  100 REM DECLARE ARRAYS FOR SIN AND COS TO 0.1 DEGREES
  110 DIM RCOS(3600), RSIN(3600)
  120 REM SET MAXIMUM COLORS TO USE
  130 MAXC%=15
  135 MODE 0
  140 CLS
  150 PROC_LOAD_LOGO
  160 LCOL%=29 : LROW%=26
  170 PROC_DRAW_LOGO(LCOL%-10,LROW%-2,4)
  180 PRINT TAB(30,50)"COMPUTING SIN, COS ARRAYS";
  190 REM SHOW FUN CIRCULAR PATTERN WHEN COMPUTING SIN AND COS
  200 R=100 : REM RADIUS OF PATTERN
  210 W=10 : REM WIDTH OF PATTERN
  220 FOR A%=0 TO 3600
  230   RCOS(A%)=COS(RAD(A%/10))
  240   RSIN(A%)=SIN(RAD(A%/10))
  250   REM PRINT RCOS(A%);",";SIN(A%)
  260   GCOL 0,A%/10 MOD 16
  270   PLOT 4,512+R*RCOS(A%),512+R*RSIN(A%)
  280   PLOT 5,512+(R+W)*RCOS(A%),512+(R+W)*RSIN(A%)
  290   R=R+RSIN(A%)/4
  300   W=W+RCOS(A%)/4
  310 NEXT A%
  320 MAXX%=1024
  330 APER%=100
  340 CLS
  350 REM RANDOMIZE ANGLE SIZE BETWEEN POLYGON VERTICES
  360 ANGST%=10*(1+RND(29))
  370 REM RANDOMIZE SCALING FACTOR FOR EACH SUCCESSIVE POLYGON IN PATTERN 
  380 SCALE=0.8+RND(190)/1000
  390 REM LOOP FOR NUMBER OF SIDES FOR EACH POLYGON (MIN 2)
  400 FOR S%=3 TO 8
  410   FOR C%=0 TO MAXC%
  420     COLOUR C%
  430     PRINT TAB(65,40+C%)"COLOR ";C%;
  440   NEXT C%
  450   PROC_DRAW_LOGO(LCOL%,LROW%,1+RND(14))
  460   PRINT TAB(62,11)"ANGLE=";ANGST%/10
  470   PRINT TAB(62,13)"SCALE=";SCALE;
  480   PRINT TAB(62,12)"SIDES=";S%;
  490   REM CALCULATE ANGLE IN 10THS OF DEG FOR NUMBER OF SIDES
  500   AD=3600/S%
  510   C%=1
  520   X%=MAXX%/2
  530   FOR A%=0 TO AD STEP ANGST%
  540     C%=C%+1
  550     GCOL 0,C%
  560     PROC_POLY(X%,MAXX%,A%,S%)
  570     IF C%>MAXC% THEN C%=1
  580   NEXT A%
  590   REM COMPUTE NEXT X VALUE SCALED FROM PREVIOUS UNTIL MIN OF APER%
  600   X%=X%*SCALE
  610   IF S%=3 AND X% >= APER% + 54 THEN GOTO 530
  620   IF S%=4 AND X% >= APER% + 32 THEN GOTO 530
  630   IF S%>4 AND X% >= APER% THEN GOTO 530
  640   REM INTRODUCE DELAY BETWEEN EACH NEW NUMBER OF SIDES
  650   K=INKEY(100)
  660   CLS
  670 NEXT S%
  680 GOTO 340
  690 END
  700 REM DEFINE PROCEDURE TO PLOT POLYGON
  710 REM GIVEN RADIUS, MAX X, STARTING ANGLE, AND NUMBER OF SIZES
  720 DEF PROC_POLY(XP%,MAXXP%,AP,NS%)
  730 CENTER%=MAXXP%/2
  740 FOR I%=1 TO NS%
  750   ADP%=INT(AP+(I%-1)*AD)
  760   RXP(I%)=CENTER%-XP%*RCOS(ADP%)
  770   RYP(I%)=CENTER%-XP%*RSIN(ADP%)
  780 NEXT I%
  790 PLOT 4,RXP(1),RYP(1)
  800 FOR I%=2 TO NS%
  810   PLOT 5,RXP(I%),RYP(I%)
  820 NEXT I%
  830 PLOT 5,RXP(1),RYP(1)
  840 ENDPROC
  850 :
  860 DEF PROC_DRAW_LOGO(COL%,ROW%,LC%) : REM **** DRAW_LOGO ****
  870 REM DISPLAY THE LOGO LINE BY LINE.
  880 COLOUR LC%
  890 PRINT TAB(COL%,ROW%);"  ";CHR$(200);CHR$(201);"   ";
  900 PRINT TAB(COL%,ROW%+1);"  ";CHR$(202);CHR$(203);"   ";
  910 PRINT TAB(COL%,ROW%+2);" ";CHR$(204);CHR$(205);CHR$(206);CHR$(207);"  ";
  920 PRINT TAB(COL%,ROW%+3);CHR$(208);CHR$(209);CHR$(210);CHR$(211);CHR$(212);CHR$(213);" ";
  930 PRINT TAB(COL%,ROW%+4);CHR$(214);CHR$(215);CHR$(216);CHR$(209);CHR$(217);CHR$(218);" ";
  940 PRINT TAB(COL%,ROW%+5);CHR$(219);CHR$(220);CHR$(221);CHR$(222);CHR$(223);CHR$(224);" ";
  950 PRINT TAB(COL%,ROW%+6);CHR$(225);CHR$(226);CHR$(227);CHR$(228);CHR$(229);CHR$(230);" ";
  960 PRINT TAB(COL%,ROW%+7);CHR$(231);CHR$(232);CHR$(233);CHR$(234);CHR$(235);CHR$(236);" ";
  970 ENDPROC : REM END PROC_DRAW_LOGO.
  980 :
  990 DEF PROC_LOAD_LOGO : REM **** LOAD LOGO ****
 1000 REM AGON LIGHT "Sitting Kung Fu man" LOAD LOGO CHARS.
 1010 :
 1020 VDU 23,200,7,15,31,31,31,31,31,63
 1030 VDU 23,201,192,224,240,240,240,240,240,248
 1040 VDU 23,202,63,63,31,15,15,15,7,7
 1050 VDU 23,203,248,248,240,224,224,224,192,192
 1060 VDU 23,204,0,1,7,15,31,63,127,127
 1070 VDU 23,205,7,199,199,195,227,225,240,240
 1080 VDU 23,206,192,195,195,135,135,15,15,31
 1090 VDU 23,207,0,0,224,240,248,252,252,254
 1100 VDU 23,208,0,0,1,1,3,3,7,7
 1110 VDU 23,209,255,255,255,255,255,255,255,255
 1120 VDU 23,210,248,248,248,240,224,225,193,195
 1130 VDU 23,211,63,63,127,255,255,255,255,255
 1140 VDU 23,212,255,255,255,255,255,255,223,223
 1150 VDU 23,213,0,0,128,128,128,192,192,192
 1160 VDU 23,214,7,7,15,15,15,15,15,31
 1170 VDU 23,215,255,247,231,231,231,199,135,130
 1180 VDU 23,216,199,135,135,143,15,15,31,31
 1190 VDU 23,217,207,207,207,199,199,195,129,1
 1200 VDU 23,218,224,224,224,240,240,240,240,240
 1210 VDU 23,219,31,31,31,31,15,15,15,31
 1220 VDU 23,220,128,128,128,128,129,143,135,143
 1230 VDU 23,221,31,63,15,0,128,224,224,195
 1240 VDU 23,222,252,240,128,0,3,7,35,243
 1250 VDU 23,223,1,1,1,129,193,225,241,241
 1260 VDU 23,224,240,240,240,240,240,240,240,240
 1270 VDU 23,225,31,31,3,3,3,3,7,15
 1280 VDU 23,226,223,255,255,255,255,255,254,254
 1290 VDU 23,227,199,135,135,7,15,15,31,31
 1300 VDU 23,228,241,241,241,248,248,248,248,248
 1310 VDU 23,229,253,255,255,255,255,255,255,127
 1320 VDU 23,230,240,248,248,224,224,224,240,248
 1330 VDU 23,231,31,63,63,63,31,31,15,0
 1340 VDU 23,232,254,252,252,252,248,248,224,0
 1350 VDU 23,233,31,60,32,0,0,0,0,0
 1360 VDU 23,234,120,28,12,12,0,0,0,0
 1370 VDU 23,235,127,127,127,127,127,63,15,0
 1380 VDU 23,236,248,252,252,252,252,248,240,0
 1390 VDU 23,237,255,254,252,248,240,224,192,128
 1400 ENDPROC : REM END PROC_LOAD_LOGO
